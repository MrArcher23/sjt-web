---
import Layout from "../components/layout/Layout.astro";
import SectionInfo from "../components/ui/SectionInfo.astro";
import strapi from "../utils/strapi";
import type { SectionInfo as SectionInfoType } from "../types/strapi";

// Intentar obtener SectionInfo desde Strapi
let sectionInfoData: SectionInfoType | null = null;
try {
  console.log("üîç Obteniendo SectionInfo desde Strapi...");
  sectionInfoData = await strapi.getActiveSectionInfo();
  console.log(
    "üìä SectionInfo obtenida:",
    sectionInfoData ? "√âxito" : "Usando fallback"
  );
} catch (error) {
  console.warn(
    "‚ö†Ô∏è SectionInfo loading failed, using fallback:",
    error instanceof Error ? error.message : error
  );
}

// Fallback est√°tico si no hay data desde Strapi
const fallbackSectionInfo: SectionInfoType = {
  title: "Plumbing solutions tailored to your needs",
  description:
    "Our team of licensed and experienced plumbers is committed to providing prompt, professional, and courteous service, ensuring that your plumbing system is always in optimal condition.",
  buttonText: "Learn more about us",
  buttonLink: "#services",
  image: {
    id: 1,
    url: "https://images.unsplash.com/photo-1621905251189-08b45d6a269e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2069&q=80",
    alternativeText: "Professional plumber working on pipes",
    name: "plumber-working.jpg",
    width: 2069,
    height: 1379,
  },
  strength1: "Experienced and certified plumbers",
  strength2: "High-quality materials and equipment",
  strength3: "Customer satisfaction guarantee",
  backgroundColor: "white" as const,
  isActive: true,
};

// Usar data de Strapi o fallback
const finalSectionInfo = sectionInfoData || fallbackSectionInfo;
---

<Layout title="SectionInfo Component Example">
  <main class="min-h-screen bg-gray-100">
    <!-- Hero/Header -->
    <section class="bg-primary-600 text-white py-16">
      <div class="container mx-auto px-4 text-center">
        <h1 class="text-4xl md:text-5xl font-bold mb-4">
          Ejemplo: Componente SectionInfo
        </h1>
        <p class="text-xl text-primary-100 max-w-2xl mx-auto">
          Componente din√°mico con imagen, t√≠tulo, descripci√≥n y fortalezas,
          gestionado desde Strapi Cloud con animaciones scroll-triggered.
        </p>
      </div>
    </section>

    <!-- SectionInfo Component - Layout Normal -->
    <SectionInfo
      title={finalSectionInfo.title}
      description={finalSectionInfo.description}
      buttonText={finalSectionInfo.buttonText}
      buttonLink={finalSectionInfo.buttonLink}
      image={finalSectionInfo.image
        ? {
            src: finalSectionInfo.image.url,
            alt:
              finalSectionInfo.image.alternativeText ||
              finalSectionInfo.image.name,
            width: finalSectionInfo.image.width,
            height: finalSectionInfo.image.height,
          }
        : undefined}
      strength1={finalSectionInfo.strength1}
      strength2={finalSectionInfo.strength2}
      strength3={finalSectionInfo.strength3}
      backgroundColor={finalSectionInfo.backgroundColor}
      reverseLayout={false}
    />

    <!-- Spacer para demostrar scroll -->
    <div
      class="h-96 bg-gradient-to-b from-gray-100 to-gray-50 flex items-center justify-center"
    >
      <div class="text-center text-gray-500">
        <p class="text-xl font-medium mb-2">
          üëÜ Scroll hacia arriba para ver la animaci√≥n
        </p>
        <p class="text-lg">
          üé¨ Los elementos aparecen cuando la secci√≥n entra en el viewport
        </p>
      </div>
    </div>

    <!-- SectionInfo Component - Layout Reverso (imagen a la derecha) -->
    <SectionInfo
      title="Advanced Construction Technologies"
      description="We leverage cutting-edge construction technologies and methodologies to deliver projects that exceed industry standards. Our innovative approach ensures efficiency, sustainability, and superior quality in every build."
      buttonText="View Our Projects"
      buttonLink="#projects"
      image={{
        src: "https://images.unsplash.com/photo-1504307651254-35680f356dfd?ixlib=rb-4.0.3&auto=format&fit=crop&w=2076&q=80",
        alt: "Modern construction site with advanced equipment",
        width: 2076,
        height: 1384,
      }}
      strength1="BIM and 3D modeling technology"
      strength2="Sustainable building practices"
      strength3="Quality control at every stage"
      backgroundColor="gray"
      reverseLayout={true}
    />

    <!-- Informaci√≥n t√©cnica -->
    <section class="bg-primary-50 py-16">
      <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto">
          <h2 class="text-3xl font-bold text-center mb-8 text-primary-900">
            üöÄ Caracter√≠sticas del Componente SectionInfo
          </h2>

          <div class="grid md:grid-cols-2 gap-8">
            <div class="bg-white rounded-lg p-6 shadow-sm">
              <h3 class="text-xl font-semibold mb-4 text-primary-700">
                ‚ú® Animaciones Inteligentes
              </h3>
              <ul class="space-y-2 text-gray-600">
                <li>
                  ‚Ä¢ <strong>Intersection Observer API</strong> para detecci√≥n scroll
                </li>
                <li>‚Ä¢ <strong>Delays escalonados</strong> en elementos</li>
                <li>‚Ä¢ <strong>Respeta prefer-reduced-motion</strong></li>
                <li>‚Ä¢ <strong>Performance optimizado</strong> (no polling)</li>
              </ul>
            </div>

            <div class="bg-white rounded-lg p-6 shadow-sm">
              <h3 class="text-xl font-semibold mb-4 text-primary-700">
                üéõÔ∏è Gesti√≥n desde Strapi
              </h3>
              <ul class="space-y-2 text-gray-600">
                <li>‚Ä¢ <strong>Content-Type din√°mico</strong></li>
                <li>‚Ä¢ <strong>Upload de im√°genes</strong></li>
                <li>‚Ä¢ <strong>3 fortalezas configurables</strong></li>
                <li>‚Ä¢ <strong>Colores de fondo variables</strong></li>
              </ul>
            </div>

            <div class="bg-white rounded-lg p-6 shadow-sm">
              <h3 class="text-xl font-semibold mb-4 text-primary-700">
                üì± Design System
              </h3>
              <ul class="space-y-2 text-gray-600">
                <li>‚Ä¢ <strong>Mobile First</strong> responsive</li>
                <li>‚Ä¢ <strong>Layout reversible</strong> (imagen izq/der)</li>
                <li>‚Ä¢ <strong>Astro Image optimizations</strong></li>
                <li>‚Ä¢ <strong>Tailwind CSS styling</strong></li>
              </ul>
            </div>

            <div class="bg-white rounded-lg p-6 shadow-sm">
              <h3 class="text-xl font-semibold mb-4 text-primary-700">
                ‚ôø Accesibilidad
              </h3>
              <ul class="space-y-2 text-gray-600">
                <li>‚Ä¢ <strong>Screen readers compatible</strong></li>
                <li>‚Ä¢ <strong>High contrast support</strong></li>
                <li>‚Ä¢ <strong>Keyboard navigation</strong></li>
                <li>‚Ä¢ <strong>Motion preferences</strong></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
</Layout>

<style>
  /* Estilos adicionales para la p√°gina de ejemplo */
  .container {
    max-width: 1200px;
  }
</style>
