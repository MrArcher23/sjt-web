---

// Layout
import BaseLayout from "../layouts/BaseLayout.astro";

// Importar im√°genes locales espec√≠ficas para esta p√°gina
import panoramica1 from "../assets/images/work/panoramica1.jpeg";
import obra1 from "../assets/images/work/obra1.jpeg";

// Componentes espec√≠ficos para esta p√°gina
import HeroSection from "../components/HeroSection.astro";
import SectionTitle from "../components/ui/SectionTitle.astro";
import SectionInfo2 from "../components/ui/SectionInfo2.astro";
import CertificationsIso from "../components/ui/CertificationsIso.astro";
import ServiceCard from "../components/ui/ServiceCard.astro";
import StrapiServiceGallery from "../components/StrapiServiceGallery.astro";

// L√≥gica espec√≠fica para la p√°gina de inicio
import strapi from "../utils/strapi";
import type {
  StrapiEntity,
  Hero as HeroType,
  SectionInfo as SectionInfoType,
  TitleSectionInfo as TitleSectionInfoType,
} from "../types/strapi";
import TitleSectionInfo from "../components/TitleSectionInfo.astro";

// Obtener contenido espec√≠fico para la home
let heroData: StrapiEntity<HeroType> | null = null;
let sectionInfoData: StrapiEntity<SectionInfoType> | null = null;
let titleSectionData: TitleSectionInfoType | null = null;
let error: string | null = null;

try {
  // Hero data
  console.log("üîç Obteniendo heroes activos");
  const heroResponse = await strapi.getActiveHeroes();
  heroData = heroResponse.data?.[0] || null;

  if (!heroData) {
    console.log("‚ö†Ô∏è No hay heroes activos, usando cualquier hero...");
    const allHeroesResponse = await strapi.getHeroes();
    heroData = allHeroesResponse.data?.[0] || null;
  }

  // Section Info data
  console.log("üîç Obteniendo section info activa");
  const sectionResponse = await strapi.getActiveSectionInfos();
  sectionInfoData = sectionResponse.data?.[0] || null;

  // Title Section Info data - Secci√≥n "Qui√©nes Somos"
  console.log("üîç Obteniendo title-section-info: landing-somos");
  titleSectionData = await strapi.getTitleSectionInfoByIdentifier("landing-somos");

} catch (e) {
  error = e instanceof Error ? e.message : "Error loading data";
  console.error("‚ùå Error cargando datos:", error);
}

// Transformar datos para los componentes
const heroProps = heroData
  ? {
      name_company: heroData.companyName,
      subtitle: heroData.subtitle,
      showOverlay: heroData.showOverlay,
      titlePosition: heroData.titlePosition as "center" | "bottom",
      backgroundVideo: heroData.backgroundVideo?.url ? { src: heroData.backgroundVideo.url } : undefined,
      backgroundImage: heroData.backgroundImage?.url,
    }
  : null;

const sectionInfoProps = sectionInfoData
  ? {
      title: sectionInfoData.title,
      description: sectionInfoData.description,
      image: sectionInfoData.image?.url || obra1.src,
      imagePosition: "right" as const, // Valor por defecto
      buttonText: sectionInfoData.buttonText,
      buttonLink: sectionInfoData.buttonLink,
    }
  : null;

// Props espec√≠ficas para el Layout de la home
const layoutProps = {
  pageTitle: "Inicio",
  metaDescription: "SJT Contratistas - L√≠deres en construcci√≥n, obra civil, terracer√≠as y desarrollo integral de proyectos en el sureste mexicano. M√°s de 20 a√±os de experiencia y excelencia.",
  showBreadcrumb: false,
  showContact: true,
  contactConfig: {
    highlightText: "escribenos y te atenderemos",
    title: "¬øTE INTERESA SABER M√ÅS?",
    subtitle: "Ponte en contacto con nosotros y te brindaremos toda la informaci√≥n que necesites sobre nuestros servicios de construcci√≥n.",
    phone: "(993) 324-5488",
    email: "contacto@sjtcontratistas.com",
    address: "Carr. Reforma-Dos Bocas s/n, Cumuapa 1ra. Tabasco",
    accentColor: "#FF5722",
    backgroundColor: "bg-gray-900",
    placeholder: "Escribe tu Email...",
    buttonText: "Enviar"
  }
};
---

<BaseLayout {...layoutProps}>
  <!-- ========================================= -->
  <!-- CONTENIDO ESPEC√çFICO DE LA P√ÅGINA HOME -->
  <!-- ========================================= -->

  <!-- Hero Section -->
  {heroProps ? (
    <HeroSection
      name_company={heroProps.name_company}
      subtitle={heroProps.subtitle}
      showOverlay={heroProps.showOverlay}
      titlePosition={heroProps.titlePosition}
      backgroundVideo={heroProps.backgroundVideo}
      backgroundImage={heroProps.backgroundImage}
    />
  ) : (
    <!-- Fallback Hero si no hay datos de Strapi -->
    <HeroSection
      name_company="Construcci√≥n y Desarrollo Integral"
      subtitle="M√°s de 20 a√±os transformando el sureste mexicano con proyectos de excelencia"
      showOverlay={true}
      titlePosition="center"
      backgroundImage={panoramica1.src}
    />
  )}
  <CertificationsIso borderColor="blue" />

  <!-- Secci√≥n "Qui√©nes Somos" desde Strapi -->
  {titleSectionData ? (
    <TitleSectionInfo
      highlightText={titleSectionData.highlightText}
      title={titleSectionData.title}
      titleSection={titleSectionData.titleSection}
      highlightColor={titleSectionData.highlightColor || "blue"}
      customColor={titleSectionData.customColor}
      alignment={titleSectionData.alignment || "left"}
      size={titleSectionData.size || "lg"}
      description={titleSectionData.description}
      image={titleSectionData.image?.url || obra1.src}
      imageAlt={titleSectionData.imageAlt || titleSectionData.image?.alternativeText}
      imagePosition={titleSectionData.imagePosition || "right"}
      buttonText={titleSectionData.buttonText}
      buttonLink={titleSectionData.buttonLink}
      floatingElement1={titleSectionData.floatingElement1 ? {
        number: titleSectionData.floatingElement1.number,
        title: titleSectionData.floatingElement1.title,
        subtitle: titleSectionData.floatingElement1.subtitle,
        svg: titleSectionData.floatingElement1.svg,
        bgColor: titleSectionData.floatingElement1.bgColor || "bg-gray-900",
        textColor: titleSectionData.floatingElement1.textColor || "text-white"
      } : undefined}
      floatingElement2={titleSectionData.floatingElement2 ? {
        number: titleSectionData.floatingElement2.number,
        title: titleSectionData.floatingElement2.title,
        subtitle: titleSectionData.floatingElement2.subtitle,
        svg: titleSectionData.floatingElement2.svg,
        bgColor: titleSectionData.floatingElement2.bgColor || "bg-orange-500",
        textColor: titleSectionData.floatingElement2.textColor || "text-white"
      } : undefined}
      backgroundColor={titleSectionData.backgroundColor}
      containerClass={titleSectionData.containerClass}
      sectionClass={titleSectionData.sectionClass}
      titleContainerClass={titleSectionData.titleContainerClass}
    />
  ) : (
    <!-- Fallback: Secci√≥n hardcodeada si no hay datos de Strapi -->
    <TitleSectionInfo
      highlightText="qui√©nes somos"
      title="L√çDERES EN LA INDUSTRIA DE CONSTRUCCI√ìN"
      titleSection="Comprometidos con la Calidad, Medio Ambiente y Seguridad"
      highlightColor="blue"
      alignment="left"
      size="lg"
      description="Somos una empresa tabasque√±a y orgullosamente mexicana, comprometida con la m√°s alta calidad en nuestros productos as√≠ como en nuestros servicios."
      image={obra1.src}
      imagePosition="right"
      buttonText="M√°s informaci√≥n"
      buttonLink="/quienes-somos"
      floatingElement1={{
        number: "500+",
        title: "Proyectos",
        subtitle: "Realizados",
        svg: `<svg class="w-full h-full" fill="currentColor" viewBox="0 0 24 24"><path d="M12 3l8 8v9a1 1 0 01-1 1h-6v-6H9v6H3a1 1 0 01-1-1v-9l8-8z"/></svg>`,
        bgColor: "bg-gray-900",
        textColor: "text-white"
      }}
      floatingElement2={{
        number: "03+",
        title: "Certificaciones",
        subtitle: "Internacionales",
        svg: `<svg class="w-full h-full" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9l-5.91.74L12 22l-3.09-6.26L2 15l5.91-.74L12 2z"/></svg>`,
        bgColor: "bg-orange-500",
        textColor: "text-white"
      }}
    />
  )}


  <div class="mx-8 sm:mx-12 lg:mx-16 xl:mx-20 px-0 mb-12">
    <SectionTitle
      highlightText="nuestros servicios"
      title="Nuestros Servicios: Profesionalismo y Excelencia"
      highlightColor="orange"
      alignment="left"
      size="lg"
    />
    <StrapiServiceGallery
   
    
    buttonColor="bg-yellow-500"
    fallbackServices={[
      {
        service_name: "Obra Civil",
        img: "https://images.unsplash.com/photo-1504307651254-35680f356dfd?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
        overlayColor: "black",
        description: "Construcci√≥n y desarrollo de infraestructura civil",
        link: "#obra-civil"
      },
      {
        service_name: "Instalaciones El√©ctricas",
        img: "https://images.unsplash.com/photo-1621905251189-08b45d6a269e?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
        overlayColor: "black",
        description: "Instalaciones y mantenimiento el√©ctrico especializado",
        link: "#electrica"
      },
      {
        service_name: "Sistemas Electromec√°nicos",
        img: "https://images.unsplash.com/photo-1581094794329-c8112a89af12?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
        overlayColor: "black",
        description: "Sistemas electromec√°nicos industriales",
        link: "#electromecanica"
      },
      {
        service_name: "Mantenimiento Industrial",
        img: "https://images.unsplash.com/photo-1558618047-3c8c76ca7d13?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
        overlayColor: "black",
        description: "Mantenimiento preventivo y correctivo",
        link: "#mantenimiento"
      }
    ]}
  />

  </div>

  
  
  <section class="py-16 bg-white">
    <div class="mx-8 sm:mx-12 lg:mx-16 xl:mx-20 px-0 mb-12">
      <SectionTitle
        highlightText="nuestra MISI√ìN"
        title="Nuestra Misi√≥n: Calidad, Integridad y Crecimiento"
        highlightColor="red"
        alignment="left"
        size="lg"
      />
    </div>
    <SectionInfo2
      title="Compromiso con la Excelencia y el Desarrollo"
      description="Ofrecer a nuestros clientes productos y servicios de ingenier√≠a de excelente calidad en los tiempos establecidos, mediante una gesti√≥n √≠ntegra y honesta, ofreciendo estabilidad laboral y oportunidades de desarrollo al personal que labora en la empresa, asegurando la inversi√≥n de los clientes y excediendo sus expectativas, a fin de garantizar la rentabilidad de las operaciones y el cumplimiento de los compromisos asumidos con los proveedores."
      image={obra1.src}
      imagePosition="right"
      buttonText="M√°s informaci√≥n"
      buttonLink="#servicios"         
      
    />
  </section>

  <section class="py-16 bg-white">
    <div class="mx-8 sm:mx-12 lg:mx-16 xl:mx-20 px-0 mb-12">
      <SectionTitle
        highlightText="nuestra visi√ìN"
        title="Nuestra Visi√≥n: Liderazgo Din√°mico y Vanguardista"
        highlightColor="blue"
        alignment="left"
        size="lg"
      />
    </div>
    <SectionInfo2
      title="Liderazgo e Innovaci√≥n en Vanguardia"
      description="ser reconocida como una empresa l√≠der y din√°mica, comprometidos a romper esquemas, coloc√°ndonos a la vanguardia en todos y cada uno de nuestros procesos para nuestros proyectos, productos y servicios."
      image={obra1.src}
      imagePosition="left"
      buttonText="M√°s informaci√≥n"
      buttonLink="#servicios"         
      
    />
  </section>

  <section class="py-16 bg-white">
    <div class="mx-8 sm:mx-12 lg:mx-16 xl:mx-20 px-0 mb-12">
      <SectionTitle
        highlightText="nuestros servicios"
        title="Nuestros Servicios: Profesionalismo y Excelencia"
        highlightColor="orange"
        alignment="left"
        size="lg"
      />
    </div>
    
    <!-- Service Cards Grid -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8">
        
        <!-- Civil Construction Service -->
        <ServiceCard
          area='<path d="M12 3l8 8v9a1 1 0 01-1 1h-6v-6H9v6H3a1 1 0 01-1-1v-9l8-8z"/>'
          serviceName="Civil Construction"
          description="We offer comprehensive civil construction services with over 20 years of experience, specializing in infrastructure development, building construction, and project management with the highest quality standards."
          buttonText="Ver m√°s"
          href="/services/civil-construction"
          cardNumber="01"
          iconColor="#FF5722"
        />

        <!-- Electrical Installations Service -->
        <ServiceCard
          area='<path d="M13 10V3L4 14h7v7l9-11h-7z"/>'
          serviceName="Electrical Systems"
          description="Professional electrical installation and maintenance services including industrial electrical systems, power distribution, lighting solutions, and electrical safety compliance for commercial and industrial projects."
          buttonText="Ver m√°s"
          href="/services/electrical-systems"
          cardNumber="02"
          iconColor="#FF5722"
        />

        <!-- Electromechanical Systems Service -->
        <ServiceCard
          area='<path d="M12 2l3.09 6.26L22 9l-5.91.74L12 22l-3.09-6.26L2 15l5.91-.74L12 2z"/><circle cx="12" cy="12" r="3"/>'
          serviceName="Electromechanical"
          description="Specialized electromechanical systems installation and maintenance including HVAC systems, pumping equipment, industrial machinery, and automated control systems for optimal operational efficiency."
          buttonText="Ver m√°s"
          href="/services/electromechanical"
          cardNumber="03"
          iconColor="#FF5722"
        />

      </div>
    </div>
   
  </section>
  

</BaseLayout>

